<div class="page-container">
  <!-- Breadcrumb -->
  <nav class="breadcrumb-nav">
    <div class="breadcrumb">
      <a class="breadcrumb-item" routerLink="/settings/plugins">
        <mat-icon>settings</mat-icon>
        Settings
      </a>
      <mat-icon class="breadcrumb-separator">chevron_right</mat-icon>
      <a class="breadcrumb-item" routerLink="/settings/plugins">
        Plugins
      </a>
      <mat-icon class="breadcrumb-separator">chevron_right</mat-icon>
      <span class="breadcrumb-item current">{{ plugin?.name || 'Plugin Details' }}</span>
    </div>
  </nav>

  <div *ngIf="loading" class="loading-container">
    <mat-spinner diameter="50"></mat-spinner>
  </div>

  <div *ngIf="!loading" class="content-wrapper">
    <div class="form-card">
      <div class="form-header">
        <div class="header-content">
          <mat-icon class="header-icon">extension</mat-icon>
          <div class="header-text">
            <h1>{{ plugin?.name || 'Plugin Details' }}</h1>
            <p class="subtitle">Manage plugin configuration</p>
          </div>
        </div>
      </div>

      <div class="form-content">
        <form [formGroup]="pluginForm" class="profile-form">
          <div class="form-section">
            <h2 class="section-title">Basic Information</h2>
            
            <div class="form-group full-width">
              <label for="name" class="form-label required">Name</label>
              <input 
                id="name"
                type="text" 
                formControlName="name" 
                class="form-input"
                [class.error]="pluginForm.get('name')?.invalid && pluginForm.get('name')?.touched"
                placeholder="Enter plugin name"
                aria-required="true"
              >
              <div *ngIf="pluginForm.get('name')?.invalid && pluginForm.get('name')?.touched" class="error-message">
                {{ getErrorMessage('name') }}
              </div>
            </div>

            <div class="form-group full-width">
              <label for="idContext" class="form-label required">Context</label>
              <select
                id="idContext"
                formControlName="idContext"
                class="form-input"
                [class.error]="pluginForm.get('idContext')?.invalid && pluginForm.get('idContext')?.touched"
                aria-required="true"
              >
                <option value="">Select a context</option>
                <option *ngFor="let context of contexts" [value]="context.id">
                  {{ context.name }}
                </option>
              </select>
              <div *ngIf="pluginForm.get('idContext')?.invalid && pluginForm.get('idContext')?.touched" class="error-message">
                {{ getErrorMessage('idContext') }}
              </div>
            </div>

            <div class="form-group full-width">
              <label for="description" class="form-label">Description</label>
              <textarea 
                id="description"
                formControlName="description" 
                class="form-textarea"
                placeholder="Enter description"
                rows="3"
              ></textarea>
            </div>

            <div class="form-group full-width">
              <label for="pluginService" class="form-label required">Plugin Service</label>
              <input 
                id="pluginService"
                type="text" 
                formControlName="pluginService" 
                class="form-input code-input"
                [class.error]="pluginForm.get('pluginService')?.invalid && pluginForm.get('pluginService')?.touched"
                placeholder="Enter plugin service class or method name"
                aria-required="true"
              >
              <div *ngIf="pluginForm.get('pluginService')?.invalid && pluginForm.get('pluginService')?.touched" class="error-message">
                {{ getErrorMessage('pluginService') }}
              </div>
              <div class="field-hint">Specify the service class or method name that implements this plugin</div>
            </div>

            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" formControlName="isActive" id="isActive" class="checkbox-input">
                <label for="isActive" class="checkbox-label">Active</label>
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button 
              type="button" 
              class="btn btn-secondary" 
              (click)="cancel()"
              [disabled]="saving"
            >
              Cancel
            </button>
            <button 
              type="button" 
              class="btn btn-primary" 
              (click)="savePlugin()" 
              [disabled]="pluginForm.invalid || saving"
            >
              <mat-icon *ngIf="saving">hourglass_empty</mat-icon>
              <mat-icon *ngIf="!saving">save</mat-icon>
              {{ saving ? 'Saving...' : 'Save Plugin' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
